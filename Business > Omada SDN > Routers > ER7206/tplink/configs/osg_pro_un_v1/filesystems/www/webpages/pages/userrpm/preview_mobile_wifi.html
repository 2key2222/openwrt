<!DOCTYPE HTML>
<html>
<head lang="zh-CN">
<meta charset="UTF-8">
    <title>微信连Wi-Fi</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    
	<script type="text/javascript">
		/* 微信连Wi-Fi协议3.1供运营商portal呼起微信浏览器使用
		----开发认证流程所需参数----
			ssid : TP-LINK_FREE_WiFi
			shopId : 4941584
			appId : wx23dc7123bfa33ab7
			secretKey : 832bb77b0ac57d9feb8d6dc04da1dc59
		----复用demo代码说明----
			若认证Portal页直接使用此Demo源代码，请注意填写代码中的以下参数（由您的网络环境动态获取）：
			extend
			timestamp
			authUrl
			mac
			bssid
			sign
			其中sign签名请在后台完成，例如：
			var toSign = appId + extend + timestamp + shopId + authUrl + mac + ssid + bssid + secretKey;
			var sign= md5(toSign);
		----参考文档----
			http://mp.weixin.qq.com/wiki/11/fdad7d19ee3fff555cf4bf215c1e50bb.html
		*/
        if ( typeof(cfgPara) == "undefined")
        {
            var cfgPara = {
                "pagetype":"portal",
                "ssid":"TP-LINK_FREE_WiFi",
                "shopId":"4941584",
                "appId":"wx23dc7123bfa33ab7",
                "secretKey":"832bb77b0ac57d9feb8d6dc04da1dc59",
                "extend":"extend",
                "mac":"mac",
                "bssid":"bssid",
                "authUrl":"http://weixin.tplogin.cn:8080/weixin/?12345",
                "background":"wifi-bgd.jpg",
                "logo":"wifi-logo.png",
                "welinfo":"欢迎您",
                "logoinfo":"欢迎使用微信连Wi-Fi",
                "btninfo":"一键打开微信连Wi-Fi"
            }
        }
        
        var uriParas = parseURLPara();
        var cfgPara = new Object();
        cfgPara.welinfo = uriParas["welinfo"];
        cfgPara.logoinfo = uriParas["logoinfo"];
        cfgPara.btninfo = uriParas["btninfo"];
        cfgPara.logoname = uriParas["logoname"];
        cfgPara.bgdname = uriParas["bgdname"];
        cfgPara.copyright = uriParas["copyright"];
        cfgPara.background = "/luci-static/resources/authserver/wifi-bgd.jpg";
        cfgPara.logo = "/luci-static/resources/authserver/wifi-logo.png";
        
        cfgPara.welinfo   = strASCdecode(cfgPara.welinfo);
        cfgPara.welinfo  = cfgPara.welinfo.replace(/&/ig,'&amp;');
        cfgPara.welinfo  = cfgPara.welinfo.replace(/</ig,'&lt;');
        cfgPara.welinfo  = cfgPara.welinfo.replace(/>/ig,'&gt;');
        
        cfgPara.logoinfo   = strASCdecode(cfgPara.logoinfo);
        cfgPara.logoinfo  = cfgPara.logoinfo.replace(/&/ig,'&amp;');
        cfgPara.logoinfo  = cfgPara.logoinfo.replace(/</ig,'&lt;');
        cfgPara.logoinfo  = cfgPara.logoinfo.replace(/>/ig,'&gt;');
        
        cfgPara.btninfo   = strASCdecode(cfgPara.btninfo);
        cfgPara.btninfo  = cfgPara.btninfo.replace(/&/ig,'&amp;');
        cfgPara.btninfo  = cfgPara.btninfo.replace(/</ig,'&lt;');
        cfgPara.btninfo  = cfgPara.btninfo.replace(/>/ig,'&gt;');
        
        cfgPara.bgdname   = strASCdecode(cfgPara.bgdname);
        cfgPara.bgdname  = cfgPara.bgdname.replace(/&/ig,'&amp;');
        cfgPara.bgdname  = cfgPara.bgdname.replace(/</ig,'&lt;');
        cfgPara.bgdname  = cfgPara.bgdname.replace(/>/ig,'&gt;');
        
        cfgPara.logoname   = strASCdecode(cfgPara.logoname);
        cfgPara.logoname  = cfgPara.logoname.replace(/&/ig,'&amp;');
        cfgPara.logoname  = cfgPara.logoname.replace(/</ig,'&lt;');
        cfgPara.logoname  = cfgPara.logoname.replace(/>/ig,'&gt;');
        
        
        cfgPara.copyright   = strASCdecode(cfgPara.copyright);
        cfgPara.copyright  = cfgPara.copyright.replace(/&/ig,'&amp;');
        cfgPara.copyright  = cfgPara.copyright.replace(/</ig,'&lt;');
        cfgPara.copyright  = cfgPara.copyright.replace(/>/ig,'&gt;');
        
		var loadIframe = null;
		var noResponse = null;
		var callUpTimestamp = 0;
        
        var $id=function(id){return document.getElementById(id)};
        var $css=function(id, type, vaule){var e=(typeof id == "string")?$id(id):id;if(typeof type == 'string')e.style[type]=vaule;else{for(var t in type){e.style[t]=type[t]}}};

        function parseURLPara()
        {
            var idx = 0;
            var locSearch = window.location.search;
            var argsStr = locSearch.slice(1,locSearch.length);
            var argv = argsStr.split('&');
            var nameVal;
            var args = []; ;

            for(idx = 0; idx < argv.length; idx ++)
            {
                nameVal = argv[idx].split('=');
                if(nameVal.length == 2)
                {
                    args[nameVal[0]] = nameVal[1];
                }
            }
            return args;
        }
        
        function asctochar(high, low)
        {
            var connect = 0;
            if ( high >= '0' && high <= '9' )
            {
                high = high.charCodeAt() - 48; 
            }
            if ( high >= 'A' && high <= 'F' )
            {
                high = high.charCodeAt() - 55;
            }
            if ( low >= '0' && low <= '9' )
            {
                low = low.charCodeAt() - 48; 
            }
            if ( low >= 'A' && low <= 'F' )
            {
                low = low.charCodeAt() - 55;
            }
            connect = high*16+low;
            return connect;
        }
        
        function strASCdecode(sourceId)
        {
            var tempstr = sourceId;/*getVar(sourceId).value*/
            var index = 0;
            var ptr = 0;
            var tempDecode = '';
            var high, low, high1,low1,high2,low2,inter1, inter2, inter;
            var charcode = 0;
            for ( index = 0; index <  tempstr.length; )
            {
                high = tempstr.slice(index,index+1);
                low  = tempstr.slice(index+1,index+2);
                inter = asctochar(high,low);
                if ( 0 <= inter && inter <= 0x007f )
                {
                    tempDecode += String.fromCharCode(inter);
                    index += 2;
                    continue;
                }
                if ( 192 <= inter && inter <= 223 )
                {
                    high1 = tempstr.slice(index+2,index+3);
                    low1 = tempstr.slice(index+3,index+4);
                    inter1 = asctochar(high1,low1);
                    charcode = ((inter-192)<<6) + (inter1-128);
                    tempDecode += String.fromCharCode(charcode);
                    index += 4;
                    continue;
                }
                if ( 224<= inter && inter <= 239 )
                {
                    high1 = tempstr.slice(index+2,index+3);
                    low1 = tempstr.slice(index+3,index+4);
                    high2 = tempstr.slice(index+4,index+5);
                    low2 = tempstr.slice(index+5,index+6);
                    inter1 = asctochar(high1,low1);
                    inter2 = asctochar(high2,low2);
                    charcode = ((inter-224)<<12)+((inter1-128)<<6)+(inter2-128);
                    tempDecode += String.fromCharCode(charcode);
                    index += 6;
                    continue;
                }
                else
                {
                    tempDecode = sourceId;
                    break;
                }
            }
            return tempDecode;
        }
        
        function array(n)
        {
            for (i=0; i<n; i++) this[i]=0;
            this.length=n;
        }		
        function integer(n) { return n%(0xffffffff+1); }

        function shr(a,b)
        {
            a=integer(a);
            b=integer(b);

            if (a-0x80000000>=0)
            {
                a   = a%0x80000000;
                a >>= b;
                a  += 0x40000000 >> (b-1);
            }
            else a >>= b;

            return a;
        }

        function shl1(a)
        {
            a = a%0x80000000;

            if (a&0x40000000==0x40000000)
            {
                a-=0x40000000;
                a*=2;
                a+=0x80000000;
            }
            else a*=2;

            return a;
        }

        function shl(a,b)
        {
            a = integer(a);
            b = integer(b);

            for (var i=0; i<b; i++)
                a=shl1(a);

            return a;
        }

        function and(a,b)
        {
            a = integer(a);
            b = integer(b);

            var t1 = (a-0x80000000);
            var t2 = (b-0x80000000);

            if (t1>=0)
                if (t2>=0)
                    return ((t1&t2)+0x80000000);
                else
                    return (t1&b);
            else
                if (t2>=0)
                    return (a&t2);
                else
                    return (a&b);
        }

        function or(a,b)
        {
            a = integer(a);
            b = integer(b);

            var t1 = (a-0x80000000);
            var t2 = (b-0x80000000);

            if (t1>=0)
                if (t2>=0)
                    return ((t1|t2)+0x80000000);
                else
                    return ((t1|b)+0x80000000);
            else
                if (t2>=0)
                    return ((a|t2)+0x80000000);
                else
                    return (a|b);
        }

        function xor(a,b)
        {
            a = integer(a);
            b = integer(b);

            var t1 = (a-0x80000000);
            var t2 = (b-0x80000000);

            if (t1>=0)
                if (t2>=0)
                    return (t1^t2);
                else
                    return ((t1^b)+0x80000000);
            else
                if (t2>=0)
                    return ((a^t2)+0x80000000);
                else
                    return (a^b);
        }

        function not(a)
        {
            a = integer(a);

            return (0xffffffff-a);
        }

        /* Here begin the real algorithm */

        var state = new array(4);
        var count = new array(2);
            count[0] = 0;
            count[1] = 0;
        var buffer = new array(64);
        var transformBuffer = new array(16);
        var digestBits = new array(16);

        var S11 = 7;
        var S12 = 12;
        var S13 = 17;
        var S14 = 22;
        var S21 = 5;
        var S22 = 9;
        var S23 = 14;
        var S24 = 20;
        var S31 = 4;
        var S32 = 11;
        var S33 = 16;
        var S34 = 23;
        var S41 = 6;
        var S42 = 10;
        var S43 = 15;
        var S44 = 21;

        function F(x,y,z)
        {
            return or(and(x,y),and(not(x),z));
        }

        function G(x,y,z)
        {
            return or(and(x,z),and(y,not(z)));
        }

        function H(x,y,z)
        {
            return xor(xor(x,y),z);
        }

        function I(x,y,z)
        {
            return xor(y,or(x,not(z)));
        }

        function rotateLeft(a,n)
        {
            return or(shl(a,n),(shr(a,(32-n))));
        }

        function FF(a,b,c,d,x,s,ac)
        {
            a = a+F(b, c, d) + x + ac;
            a = rotateLeft(a, s);
            a = a+b;
            return a;
        }

        function GG(a,b,c,d,x,s,ac)
        {
            a = a+G(b,c,d)+x+ac;
            a = rotateLeft(a,s);
            a = a+b;
            return a;
        }

        function HH(a,b,c,d,x,s,ac)
        {
            a = a+H(b, c, d) + x + ac;
            a = rotateLeft(a, s);
            a = a+b;
            return a;
        }

        function II(a,b,c,d,x,s,ac)
        {
            a = a+I(b, c, d) + x + ac;
            a = rotateLeft(a, s);
            a = a+b;
            return a;
        }

        function transform(buf,offset)
        {
            var a=0, b=0, c=0, d=0;
            var x = transformBuffer;

            a = state[0];
            b = state[1];
            c = state[2];
            d = state[3];

            for (i = 0; i < 16; i++)
            {
                x[i] = and(buf[i*4+offset],0xff);

                for (j = 1; j < 4; j++)
                {
                    x[i]+=shl(and(buf[i*4+j+offset] ,0xff), j * 8);
                }
            }

            /* Round 1 */
            a = FF ( a, b, c, d, x[ 0], S11, 0xd76aa478); /* 1 */
            d = FF ( d, a, b, c, x[ 1], S12, 0xe8c7b756); /* 2 */
            c = FF ( c, d, a, b, x[ 2], S13, 0x242070db); /* 3 */
            b = FF ( b, c, d, a, x[ 3], S14, 0xc1bdceee); /* 4 */
            a = FF ( a, b, c, d, x[ 4], S11, 0xf57c0faf); /* 5 */
            d = FF ( d, a, b, c, x[ 5], S12, 0x4787c62a); /* 6 */
            c = FF ( c, d, a, b, x[ 6], S13, 0xa8304613); /* 7 */
            b = FF ( b, c, d, a, x[ 7], S14, 0xfd469501); /* 8 */
            a = FF ( a, b, c, d, x[ 8], S11, 0x698098d8); /* 9 */
            d = FF ( d, a, b, c, x[ 9], S12, 0x8b44f7af); /* 10 */
            c = FF ( c, d, a, b, x[10], S13, 0xffff5bb1); /* 11 */
            b = FF ( b, c, d, a, x[11], S14, 0x895cd7be); /* 12 */
            a = FF ( a, b, c, d, x[12], S11, 0x6b901122); /* 13 */
            d = FF ( d, a, b, c, x[13], S12, 0xfd987193); /* 14 */
            c = FF ( c, d, a, b, x[14], S13, 0xa679438e); /* 15 */
            b = FF ( b, c, d, a, x[15], S14, 0x49b40821); /* 16 */

            /* Round 2 */
            a = GG ( a, b, c, d, x[ 1], S21, 0xf61e2562); /* 17 */
            d = GG ( d, a, b, c, x[ 6], S22, 0xc040b340); /* 18 */
            c = GG ( c, d, a, b, x[11], S23, 0x265e5a51); /* 19 */
            b = GG ( b, c, d, a, x[ 0], S24, 0xe9b6c7aa); /* 20 */
            a = GG ( a, b, c, d, x[ 5], S21, 0xd62f105d); /* 21 */
            d = GG ( d, a, b, c, x[10], S22,  0x2441453); /* 22 */
            c = GG ( c, d, a, b, x[15], S23, 0xd8a1e681); /* 23 */
            b = GG ( b, c, d, a, x[ 4], S24, 0xe7d3fbc8); /* 24 */
            a = GG ( a, b, c, d, x[ 9], S21, 0x21e1cde6); /* 25 */
            d = GG ( d, a, b, c, x[14], S22, 0xc33707d6); /* 26 */
            c = GG ( c, d, a, b, x[ 3], S23, 0xf4d50d87); /* 27 */
            b = GG ( b, c, d, a, x[ 8], S24, 0x455a14ed); /* 28 */
            a = GG ( a, b, c, d, x[13], S21, 0xa9e3e905); /* 29 */
            d = GG ( d, a, b, c, x[ 2], S22, 0xfcefa3f8); /* 30 */
            c = GG ( c, d, a, b, x[ 7], S23, 0x676f02d9); /* 31 */
            b = GG ( b, c, d, a, x[12], S24, 0x8d2a4c8a); /* 32 */

            /* Round 3 */
            a = HH ( a, b, c, d, x[ 5], S31, 0xfffa3942); /* 33 */
            d = HH ( d, a, b, c, x[ 8], S32, 0x8771f681); /* 34 */
            c = HH ( c, d, a, b, x[11], S33, 0x6d9d6122); /* 35 */
            b = HH ( b, c, d, a, x[14], S34, 0xfde5380c); /* 36 */
            a = HH ( a, b, c, d, x[ 1], S31, 0xa4beea44); /* 37 */
            d = HH ( d, a, b, c, x[ 4], S32, 0x4bdecfa9); /* 38 */
            c = HH ( c, d, a, b, x[ 7], S33, 0xf6bb4b60); /* 39 */
            b = HH ( b, c, d, a, x[10], S34, 0xbebfbc70); /* 40 */
            a = HH ( a, b, c, d, x[13], S31, 0x289b7ec6); /* 41 */
            d = HH ( d, a, b, c, x[ 0], S32, 0xeaa127fa); /* 42 */
            c = HH ( c, d, a, b, x[ 3], S33, 0xd4ef3085); /* 43 */
            b = HH ( b, c, d, a, x[ 6], S34,  0x4881d05); /* 44 */
            a = HH ( a, b, c, d, x[ 9], S31, 0xd9d4d039); /* 45 */
            d = HH ( d, a, b, c, x[12], S32, 0xe6db99e5); /* 46 */
            c = HH ( c, d, a, b, x[15], S33, 0x1fa27cf8); /* 47 */
            b = HH ( b, c, d, a, x[ 2], S34, 0xc4ac5665); /* 48 */

            /* Round 4 */
            a = II ( a, b, c, d, x[ 0], S41, 0xf4292244); /* 49 */
            d = II ( d, a, b, c, x[ 7], S42, 0x432aff97); /* 50 */
            c = II ( c, d, a, b, x[14], S43, 0xab9423a7); /* 51 */
            b = II ( b, c, d, a, x[ 5], S44, 0xfc93a039); /* 52 */
            a = II ( a, b, c, d, x[12], S41, 0x655b59c3); /* 53 */
            d = II ( d, a, b, c, x[ 3], S42, 0x8f0ccc92); /* 54 */
            c = II ( c, d, a, b, x[10], S43, 0xffeff47d); /* 55 */
            b = II ( b, c, d, a, x[ 1], S44, 0x85845dd1); /* 56 */
            a = II ( a, b, c, d, x[ 8], S41, 0x6fa87e4f); /* 57 */
            d = II ( d, a, b, c, x[15], S42, 0xfe2ce6e0); /* 58 */
            c = II ( c, d, a, b, x[ 6], S43, 0xa3014314); /* 59 */
            b = II ( b, c, d, a, x[13], S44, 0x4e0811a1); /* 60 */
            a = II ( a, b, c, d, x[ 4], S41, 0xf7537e82); /* 61 */
            d = II ( d, a, b, c, x[11], S42, 0xbd3af235); /* 62 */
            c = II ( c, d, a, b, x[ 2], S43, 0x2ad7d2bb); /* 63 */
            b = II ( b, c, d, a, x[ 9], S44, 0xeb86d391); /* 64 */

            state[0] +=a;
            state[1] +=b;
            state[2] +=c;
            state[3] +=d;

        }

        function init()
        {
            count[0]=count[1] = 0;
            state[0] = 0x67452301;
            state[1] = 0xefcdab89;
            state[2] = 0x98badcfe;
            state[3] = 0x10325476;
            for (i = 0; i < digestBits.length; i++)
                digestBits[i] = 0;
        }

        function update(b)
        {
            var index,i;

            index = and(shr(count[0],3) , 0x3f);
            if (count[0]<0xffffffff-7)
              count[0] += 8;
            else {
              count[1]++;
              count[0]-=0xffffffff+1;
              count[0]+=8;
            }
            buffer[index] = and(b,0xff);
            if (index  >= 63) {
                transform(buffer, 0);
            }
        }

        function finish()
        {
            var bits = new array(8);
            var padding;
            var i=0, index=0, padLen=0;

            for (i = 0; i < 4; i++)
            {
                bits[i] = and(shr(count[0],(i * 8)), 0xff);
            }

            for (i = 0; i < 4; i++)
            {
                bits[i+4]=and(shr(count[1],(i * 8)), 0xff);
            }

            index = and(shr(count[0], 3) ,0x3f);
            padLen = (index < 56) ? (56 - index) : (120 - index);
            padding = new array(64);
            padding[0] = 0x80;

            for (i=0;i<padLen;i++)
              update(padding[i]);

            for (i=0;i<8;i++)
              update(bits[i]);

            for (i = 0; i < 4; i++)
            {
                for (j = 0; j < 4; j++)
                {
                    digestBits[i*4+j] = and(shr(state[i], (j * 8)) , 0xff);
                }
            }
        }

        /* End of the MD5 algorithm */

        function hexa(n) {
         var hexa_h = "0123456789abcdef";
         var hexa_c="";
         var hexa_m=n;
         for (hexa_i=0;hexa_i<8;hexa_i++) {
           hexa_c=hexa_h.charAt(Math.abs(hexa_m)%16)+hexa_c;
           hexa_m=Math.floor(hexa_m/16);
         }
         return hexa_c;
        }


        var ascii="01234567890123456789012345678901" + " !\"#" + '\$' + "%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ"+       "[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";

        function md5(entree)
        {
         var l,s,k,ka,kb,kc,kd;

         init();
         for (k=0;k<entree.length;k++) {
           l=entree.charAt(k);
           update(ascii.lastIndexOf(l));
         }
         finish();
         ka=kb=kc=kd=0;
         for (i=0;i<4;i++) ka+=shl(digestBits[15-i], (i*8));
         for (i=4;i<8;i++) kb+=shl(digestBits[15-i], ((i-4)*8));
         for (i=8;i<12;i++) kc+=shl(digestBits[15-i], ((i-8)*8));
         for (i=12;i<16;i++) kd+=shl(digestBits[15-i], ((i-12)*8));
         s=hexa(kd)+hexa(kc)+hexa(kb)+hexa(ka);
         return s;
        }
        
        function pageConfigParse(){
            if("" == cfgPara.logoname){
                $id('img_logo').src = "";
                $css('img_logo', 'visibility', 'hidden');
            }else{
                if(1 == parseInt(uriParas["uploadLogo"])){
                    $id('img_logo').src = "/luci-static/resources/authserver/" + "wifi_logo.png";
                }else{
                    if("add" == uriParas["edittype"]){
                        $id('img_logo').src = cfgPara.logo;
                    }else{
                        $id('img_logo').src = "/luci-static/resources/authserver/" + uriParas["rulename"] + "_wifilogo.png";
                    }
                }
            }
            
            if(1 == parseInt(uriParas["uploadBgd"])){
                $id('img_background').src = "/luci-static/resources/authserver/" + "wifi_bgd.jpg";
            }else{
                if("add" == uriParas["edittype"]){
                    $id('img_background').src = cfgPara.background;
                }else{
                    $id('img_background').src = "/luci-static/resources/authserver/" + uriParas["rulename"] + "_wifibgd.jpg";
                }
            }
            
            $id('txt_welinfo').innerHTML = cfgPara.welinfo;
            $id('txt_logoinfo').innerHTML = cfgPara.logoinfo;
            $id('txt_btninfo').innerHTML = cfgPara.btninfo;
            $id('txt_copyright').innerHTML = cfgPara.copyright;
        }
		 
		function putNoResponse(ev){
			 clearTimeout(noResponse);
		}	
		
		 function errorJump()
		 {
			 var now = new Date().getTime();
			 if((now - callUpTimestamp) > 4*1000){
				 return;
			 }
			 alert('该浏览器不支持自动跳转微信请手动打开微信\n如果已跳转请忽略此提示');
		 }
		 
		 myHandler = function(error) {
			 errorJump();
		 };
		 
		 function createIframe(){
			 var iframe = document.createElement("iframe");
		     iframe.style.cssText = "display:none;width:0px;height:0px;";
		     document.body.appendChild(iframe);
		     loadIframe = iframe;
		 }
		//注册回调函数
		function jsonpCallback(result){  
			if(result && result.success){
			    var ua=navigator.userAgent;              
				if (ua.indexOf("iPhone") != -1 ||ua.indexOf("iPod")!=-1||ua.indexOf("iPad") != -1) {   //iPhone             
					document.location = result.data;
				}else{			
				    createIframe();
				    callUpTimestamp = new Date().getTime();
				    loadIframe.src=result.data;
					noResponse = setTimeout(function(){
						errorJump();
			      	},3000);
				}			    
			}else if(result && !result.success){
				alert(result.data);
			}
		}
		function Wechat_GotoRedirect(appId, extend, timestamp, sign, shopId, authUrl, mac, ssid, bssid){
			//将回调函数名称带到服务器端
			var url = "https://wifi.weixin.qq.com/operator/callWechatBrowser.xhtml?appId=" + appId 
								+ "&extend=" + extend 
								+ "&timestamp=" + timestamp 
								+ "&sign=" + sign;	
			
			//如果sign后面的参数有值，则是新3.1发起的流程
			if(authUrl && shopId){
				url = "https://wifi.weixin.qq.com/operator/callWechat.xhtml?appId=" + appId 
								+ "&extend=" + extend 
								+ "&timestamp=" + timestamp 
								+ "&sign=" + sign
								+ "&shopId=" + shopId
								+ "&authUrl=" + encodeURIComponent(authUrl)
								+ "&mac=" + mac
								+ "&ssid=" + ssid
								+ "&bssid=" + bssid;
				
			}			
			
			//通过dom操作创建script节点实现异步请求  
			var script = document.createElement('script');  
			script.setAttribute('src', url);  
			document.getElementsByTagName('head')[0].appendChild(script);
		}
	</script>
	
	
<link rel="stylesheet" href="/luci-static/resources/authserver/style-simple-follow.css"/>
</head>
<body class="mod-simple-follow">
<div class="mod-simple-follow-page">
    <div class="mod-simple-follow-page__banner">
        <img id="img_background" class="mod-simple-follow-page__banner-bg" src="" alt=""/>
        <div class="mod-simple-follow-page__img-shadow"></div>
        <div id="div_logo" class="mod-simple-follow-page__logo">
            <img id="img_logo" class="mod-simple-follow-page__logo-img" src="" alt=""/>
            <p class="mod-simple-follow-page__logo-name"></p>
            <p id="txt_logoinfo" class="mod-simple-follow-page__logo-welcome">欢迎您</p>
        </div>
    </div>
    <div class="mod-simple-follow-page__attention">
        <p id="txt_welinfo" class="mod-simple-follow-page__attention-txt">欢迎使用微信连Wi-Fi</p>
        <a id="txt_btninfo" class="mod-simple-follow-page__attention-btn" onclick="callWechatBrowser()">一键打开微信连Wi-Fi</a>
    </div>
    <div class="footer">
        <div id="txt_copyright" class="footer_copyright">Copyright © 2016 TP-LINK. All Rights Reserved.</div>
    </div>
</div>
</body>


<script type="text/javascript">
	function callWechatBrowser(){
        /*
		var authUrl = cfgPara.authUrl;
		var timestamp = Date.parse(new Date());
		var appId = cfgPara.appId;
		var extend = cfgPara.extend;
		var shopId = cfgPara.shopId;
		var mac = cfgPara.mac;
		var ssid = cfgPara.ssid;
		var bssid= cfgPara.bssid;
		var secretKey = cfgPara.secretKey;
		var toSign = appId + extend + timestamp + shopId + authUrl + mac + ssid + bssid + secretKey;
		var sign= md5(toSign);
		Wechat_GotoRedirect('wx23dc7123bfa33ab7', extend, timestamp, sign, shopId, authUrl, mac, ssid, bssid);
        */
        return false;
	}
</script>

<script type="text/javascript">
    (function onLoad(){
        document.addEventListener('visibilitychange', putNoResponse, false);
        pageConfigParse();
    })();
	
</script>
</html>
	
