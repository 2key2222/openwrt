<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    </style>
    <title>Wportal</title>
</head>

<body>
<div class="func-container">
    <div id="sessmngr_list_container">
        <div id="sessmngr_list"></div>
    </div>
    <div id="sessmngr_list_help"> </div>
</div>

<script type="text/javascript">

//<![CDATA[
try{
    $
}catch(e){
    location.href = "/";
};

function formatDate(now) { 
    var year=now.getYear(); 
    var month=now.getMonth()+1; 
    var date=now.getDate(); 
    var hour=now.getHours(); 
    var minute=now.getMinutes(); 
    var second=now.getSeconds(); 
    return year+"-"+month+"-"+date+" "+hour+":"+minute+":"+second; 
} 

$(document).ready(function(e){
    var URL_GLOBAL = $.su.url("/admin/sessmngr?form=sessmngr");
    var $sessmngr = $("#sessmngr_list");
    $("#sessmngr_list_container").panel({
        title:$.su.CHAR.AC_WPORTAL.SESSMNGR_USER_LIST// "认证用户列表"
    });

    var globalProxy = new $.su.Proxy({
        url: URL_GLOBAL
    });

    var grid = $sessmngr.grid({
        store: {
            proxy: globalProxy,
            extraProperty: ["ip", "mac"],
            autoLoad: true,
            fields: [
                {name: "authtype"},
                {name: "ip"},
                {name: "username"},
                {name: "uptime"},
                {name: "mac"}
            ]
        },
        editor: {
            content: '#wportal-editor',
            fields: [
                {name: "authtype"},
                {name: "ip"},
                {name: "username"},
                {name: "uptime"},
                {name: "mac"}
            ]
        },paging:[],
        columns: [
            {
                xtype: 'checkcolumn',
                width: $.su.CHAR.SETTING.VPN_USER.CHECK_COLUMN_WIDTH
            },
            {
                xtype: 'rownumberer',
                width: $.su.CHAR.SETTING.VPN_USER.ROW_NUMBER_WIDTH
            },
            {
                text: $.su.CHAR.AC_WPORTAL.SESSMNGR_AUTH_TYPE,//'认证方式',
                width: 50,
                dataIndex: 'authtype',
                renderer:function(v)
                {
                    //console.log(v);
                    var viewtype="";
                    if("web" == v){
                        viewtype = $.su.CHAR.AC_WPORTAL.SESSMNGR_AUTH_TYPE_LOCAL;//"本地认证";
                    }else if("onekey" == v){
                        viewtype = $.su.CHAR.AC_WPORTAL.SESSMNGR_AUTH_TYPE_ONEKEY;//"一键上网";
                    }else if("radius" == v){
                        viewtype = $.su.CHAR.AC_WPORTAL.SESSMNGR_AUTH_TYPE_RADIUS;//"radius认证";
                    /*}else if("wechat" == v){
                        viewtype = "微信认证";
                    }else if("wifi" == v){
                        viewtype = "微信连Wi-Fi";*/
                    }else{
                        viewtype = "--";
                    }
                    return viewtype;
                }
            },
            /*{
                text: $.su.CHAR.AC_WPORTAL.SESSMNGR_USERNAME,//'用户名',
                width: 50,
                dataIndex: 'username'
            },*/
            {
                text: $.su.CHAR.AC_WPORTAL.START_TIME,//'接入时间',
                width: 90,
                dataIndex: 'uptime',
                renderer:function(v)
                {
                    //console.log(v)
                    //return (new Date(parseInt(v) * 1000).toLocaleString().replace(/年|月/g, "-").replace(/日/g, " ")); 
                    return v;
                }
            },
            {
                text: $.su.CHAR.AC_WPORTAL.IPADDR,//'IP地址',
                width: 70,
                dataIndex: 'ip'
            },
            {
                text: $.su.CHAR.AC_WPORTAL.MACADDR,//'MAC地址',
                width: 80,
                dataIndex: 'mac'
            },

			{
                xtype: "settings",
                width: 30,
	   renderer: function(type, dd, index, data){
                    if(type === 'delete'){
                        return true;
                    }
                }
            }
        ],
		operation: [{
				xtype: "totalCount",
				cls: "left",
				fieldLabel: $.su.CHAR.AC_WPORTAL.SESSMNGR_LIST_NUM,// "条目数量",
			},"refresh","delete"]
    }).on("ev_load", function(e,data, others){
            if(others)/* 閫氳繃json閲岀殑others鍙傛暟浼犻€掑姩鎬侀榾鍊?*/
            {
                /*淇濈暀涓嶇敤*/
                //console.log(others.max_rules);
                maxrules = others.max_rules;
            }
            $($.find("a.grid-content-btn.grid-content-btn-delete.btn-delete")).attr("title",$.su.CHAR.AC_WPORTAL.OFFLINE);//"下线");
            $(grid.find("a.operation-btn.btn-delete.lst")).find("span.text").html($.su.CHAR.AC_WPORTAL.OFFLINE);//"下线");
        });
        $(grid.find("a.operation-btn.btn-delete.lst")).find("span.text").html($.su.CHAR.AC_WPORTAL.OFFLINE);//"下线");

    var helpSessmngr = new $.su.Help({
        container: "div#sessmngr_list_help",
        content: "SESSMNGR_LIST"
    })
});
//]]>
</script>
</body>

</html>