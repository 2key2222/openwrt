--- a/arch/mips/ath79/Kconfig	星期五 十二月 25 14:37:44 2015
+++ b/arch/mips/ath79/Kconfig	星期五 十二月 25 14:37:44 2015
@@ -757,6 +757,16 @@
 	select ATH79_DEV_WMAC
 	select ATH79_DEV_ETH
 	select ATH79_DEV_M25P80
+	
+config ATH79_MACH_TL_ER604W_V3
+	bool "TP-LINK TL-ER604W-V3 support"
+	select SOC_QCA956X
+	select ATH79_DEV_GPIO_BUTTONS
+	select ATH79_DEV_LEDS_GPIO
+	select ATH79_DEV_SPI
+	select ATH79_DEV_WMAC
+	select ATH79_DEV_ETH
+	select ATH79_DEV_M25P80
 
 config ATH79_MACH_TL_WR2543N
 	bool "TP-LINK TL-WR2543N/ND support"
--- a/arch/mips/ath79/Makefile	星期一 十二月 21 10:20:48 2015
+++ b/arch/mips/ath79/Makefile	星期五 十二月 25 14:42:05 2015
@@ -108,6 +108,7 @@
 obj-$(CONFIG_ATH79_MACH_TL_WVR1300G)     += mach-tl-wvr1300g.o
 obj-$(CONFIG_ATH79_MACH_TL_R478GV2)     += mach-tl-r478g-v2.o
 obj-$(CONFIG_ATH79_MACH_TL_R600VPN_V4)  += mach-tl-r600vpn-v4.o
+obj-$(CONFIG_ATH79_MACH_TL_ER604W_V3)  += mach-tl-er604w-v3.o
 obj-$(CONFIG_ATH79_MACH_TL_WR1043ND)	+= mach-tl-wr1043nd.o
 obj-$(CONFIG_ATH79_MACH_TL_WR2543N)	+= mach-tl-wr2543n.o
 obj-$(CONFIG_ATH79_MACH_TL_WR703N)	+= mach-tl-wr703n.o
--- a/arch/mips/ath79/machtypes.h	星期一 十二月 21 10:20:48 2015
+++ b/arch/mips/ath79/machtypes.h	星期五 十二月 25 14:46:53 2015
@@ -133,6 +133,7 @@
 	ATH79_MACH_TL_WVR1300G,		/*wvr1300g*/
 	ATH79_MACH_TL_R478GV2,		/*r478gv2*/
 	ATH79_MACH_TL_R600VPN_V4,	/*r600vpnv4*/
+	ATH79_MACH_TL_ER604W_V3,	/*er604wv3*/
 };
 
 #endif /* _ATH79_MACHTYPE_H */
--- a/arch/mips/kernel/setup.c	星期一 十二月 21 10:20:48 2015
+++ b/arch/mips/kernel/setup.c	星期五 十二月 25 14:49:45 2015
@@ -557,6 +557,12 @@
 	pr_info("@@----debug cmdline=[ %s ]\n", command_line);
 #endif
 
+#ifdef CONFIG_ATH79_MACH_TL_ER604W_V3
+	strlcpy(command_line, " board=TL-ER604WV3 console=ttyS0,115200 root=31:02 init=/sbin/init mtdparts=spi0.0:256k(u-boot)ro,3072k(kernel),12288k(rootfs)", COMMAND_LINE_SIZE);
+
+	pr_info("@@----debug cmdline=[ %s ]\n", command_line);
+#endif
+
 	*cmdline_p = command_line;
 
 	parse_early_param();
