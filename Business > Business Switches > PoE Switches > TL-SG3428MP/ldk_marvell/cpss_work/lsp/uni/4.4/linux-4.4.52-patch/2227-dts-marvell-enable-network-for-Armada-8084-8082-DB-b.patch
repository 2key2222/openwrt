From 295bceb50dd6e877f6e8d23885cf2144ccd0a985 Mon Sep 17 00:00:00 2001
From: Stefan Chulski <stefanc@marvell.com>
Date: Sun, 26 Nov 2017 10:35:57 +0200
Subject: [PATCH 2227/2241] dts: marvell: enable network for Armada 8084 & 8082
 DB boards

Change-Id: I8033f96425a067a755c58fe1bc71cf2fbdcbf1e9
Signed-off-by: Stefan Chulski <stefanc@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/46841
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Tested-by: Hanna Hawa <hannah@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/49346
Reviewed-by: Omri Itach <omrii@marvell.com>
Tested-by: Omri Itach <omrii@marvell.com>
---
 arch/arm64/boot/dts/marvell/armada-8082-db.dts | 62 ++++++++++++++++++
 arch/arm64/boot/dts/marvell/armada-8084-db.dts | 89 ++++++++++++++++++++++++++
 2 files changed, 151 insertions(+)

diff --git a/arch/arm64/boot/dts/marvell/armada-8082-db.dts b/arch/arm64/boot/dts/marvell/armada-8082-db.dts
index edc4b92..c20e8a0 100644
--- a/arch/arm64/boot/dts/marvell/armada-8082-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8082-db.dts
@@ -55,6 +55,13 @@
 		stdout-path = "serial0:115200n8";
 	};
 
+	aliases {
+		ethernet0 = &cp0_emac0;
+		ethernet1 = &cp0_emac2;
+		ethernet2 = &cp0_emac3;
+		ethernet3 = &cp1_emac0;
+	};
+
 	memory@00000000 {
 		device_type = "memory";
 		reg = <0x0 0x0 0x0 0x80000000>;
@@ -74,6 +81,47 @@
 	status = "okay";
 };
 
+&cp0_mdio0 {
+	status = "okay";
+	mdio0_phy0: ethernet-phy@0 {
+		reg = <0>;
+	};
+	mdio0_phy1: ethernet-phy@1 {
+		reg = <1>;
+	};
+};
+
+&cp0_emac2 {
+	phy-mode = "rgmii"; /* rgmii-0 */
+	phy = <&mdio0_phy0>;
+};
+
+&cp0_emac3 {
+	phy-mode = "rgmii"; /* rgmii-1 */
+	phy = <&mdio0_phy1>;
+};
+
+&cp0_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp0_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp0_eth0 {
+	status = "okay";
+};
+
+&cp0_eth1 {
+	status = "okay";
+};
+
+&cp0_eth2 {
+	status = "okay";
+};
+
 &cp1_sata {
 	status = "okay";
 	sata-port@1 {
@@ -86,3 +134,17 @@
 	num-lanes = <4>;
 	status = "okay";
 };
+
+
+&cp1_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp1_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp1_eth0 {
+	status = "okay";
+};
diff --git a/arch/arm64/boot/dts/marvell/armada-8084-db.dts b/arch/arm64/boot/dts/marvell/armada-8084-db.dts
index 0197ed3..d4f7b26 100644
--- a/arch/arm64/boot/dts/marvell/armada-8084-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8084-db.dts
@@ -55,6 +55,15 @@
 		stdout-path = "serial0:115200n8";
 	};
 
+	aliases {
+		ethernet0 = &cp0_emac0;
+		ethernet1 = &cp0_emac2;
+		ethernet2 = &cp0_emac3;
+		ethernet3 = &cp1_emac0;
+		ethernet4 = &cp2_emac0;
+		ethernet5 = &cp3_emac0;
+	};
+
 	memory@00000000 {
 		device_type = "memory";
 		reg = <0x0 0x0 0x0 0x80000000>;
@@ -74,6 +83,47 @@
 	status = "okay";
 };
 
+&cp0_mdio0 {
+	status = "okay";
+	mdio0_phy0: ethernet-phy@0 {
+		reg = <0>;
+	};
+	mdio0_phy1: ethernet-phy@1 {
+		reg = <1>;
+	};
+};
+
+&cp0_emac2 {
+	phy-mode = "rgmii"; /* rgmii-0 */
+	phy = <&mdio0_phy0>;
+};
+
+&cp0_emac3 {
+	phy-mode = "rgmii"; /* rgmii-1 */
+	phy = <&mdio0_phy1>;
+};
+
+&cp0_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp0_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp0_eth0 {
+	status = "okay";
+};
+
+&cp0_eth1 {
+	status = "okay";
+};
+
+&cp0_eth2 {
+	status = "okay";
+};
+
 &cp1_sata {
 	status = "okay";
 	sata-port@1 {
@@ -87,6 +137,19 @@
 	status = "okay";
 };
 
+&cp1_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp1_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp1_eth0 {
+	status = "okay";
+};
+
 &cp2_sata {
 	status = "okay";
 	sata-port@1 {
@@ -102,3 +165,29 @@
 		status = "okay";
 	};
 };
+
+&cp2_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp2_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp2_eth0 {
+	status = "okay";
+};
+
+&cp3_emac0 {
+	phy-mode = "sfi"; /* lane-2 */
+};
+
+&cp3_ppv22 {
+	l4_chksum_jumbo_port = <0>;
+	pinctrl-names = "default";
+};
+
+&cp3_eth0 {
+	status = "okay";
+};
-- 
2.7.4

