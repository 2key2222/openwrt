From c0019c988160f31713ee91412bf968b58c7b4752 Mon Sep 17 00:00:00 2001
From: Gregory CLEMENT <gregory.clement@free-electrons.com>
Date: Wed, 14 Dec 2016 17:43:48 +0100
Subject: [PATCH 1914/2241] ARM64: dts: marvell: armada37xx: add pinctrl
 definition

Start to populate the device tree of the Armada 37xx with the pincontrol
configuration used on the board providing a dts.

Cherry-picked from branch linux-4.12-devel and minor changes because of
the slightly different dts version.

Change-Id: Ib3e10c259b28f3a8c34cc9f1c3f27edab7e8f4de
Signed-off-by: Gregory CLEMENT <gregory.clement@free-electrons.com>
Signed-off-by: Ken Ma <make@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/42773
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Evan Wang <xswang@marvell.com>
Reviewed-by: Victor Gu <xigu@marvell.com>
---
 arch/arm64/boot/dts/marvell/armada-3720-db.dts | 10 ++++++-
 arch/arm64/boot/dts/marvell/armada-37xx.dtsi   | 40 ++++++++++++++++++++------
 2 files changed, 40 insertions(+), 10 deletions(-)

diff --git a/arch/arm64/boot/dts/marvell/armada-3720-db.dts b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
index 12b146f..c428f0c 100644
--- a/arch/arm64/boot/dts/marvell/armada-3720-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
@@ -64,6 +64,8 @@
 	soc {
 		internal-regs {
 			spi0: spi@10600 {
+				pinctrl-names = "default";
+				pinctrl-0 = <&spi_quad_pins>;
 				status = "okay";
 
 				m25p80@0 {
@@ -94,6 +96,8 @@
 			};
 
 			i2c0: i2c@11000 {
+				pinctrl-names = "default";
+				pinctrl-0 = <&i2c1_pins>;
 				status = "okay";
 				expander0: pca9555@22 {
 					compatible = "nxp,pca9555";
@@ -116,16 +120,20 @@
 			* through an FTDI
 			*/
 			uart0: serial@12000 {
+				pinctrl-names = "default";
+				pinctrl-0 = <&uart1_pins>;
 				status = "okay";
 			};
 
 			uart1: serial@12200 {
 				pinctrl-names = "default";
-				pinctrl-0 = <&uart1_pins>;
+				pinctrl-0 = <&uart2_pins>;
 				status = "okay";
 			};
 
 			eth0: ethernet@30000 {
+				pinctrl-names = "default";
+				pinctrl-0 = <&rgmii_pins>;
 				phy-mode = "rgmii-id";
 				phy = <&phy0>;
 				status = "okay";
diff --git a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
index 0eab322..d540957 100644
--- a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
@@ -205,21 +205,12 @@
 					marvell,function = "spi";
 				};
 
-				spi_quad_pins: spi-quad-pins {
-					marvell,pins = "mpp15", "mpp16";
-					marvell,function = "spi-quad";
-				};
-
 				mmc_pins: mmc-pins {
 					marvell,pins = "mpp27", "mpp28", "mpp29", "mpp30",
 							"mpp31", "mpp32", "mpp33", "mpp34", "mpp35";
 					marvell,function = "mmc";
 				};
 
-				uart1_pins: uart1_pins {
-					marvell,pins = "mpp18", "mpp19";
-					marvell,function = "uart2";
-				};
 			};
 
 			cpu_pm_clk: cpu-pm-clk@14018 {
@@ -320,6 +311,31 @@
 					clock-output-names = "xtal";
 					#clock-cells = <0>;
 				};
+
+				spi_quad_pins: spi-quad-pins {
+					groups = "spi_quad";
+					function = "spi";
+				};
+
+				i2c1_pins: i2c1-pins {
+					groups = "i2c1";
+					function = "i2c";
+				};
+
+				i2c2_pins: i2c2-pins {
+					groups = "i2c2";
+					function = "i2c";
+				};
+
+				uart1_pins: uart1-pins {
+					groups = "uart1";
+					function = "uart";
+				};
+
+				uart2_pins: uart2-pins {
+					groups = "uart2";
+					function = "uart";
+				};
 			};
 
 			pinctrl_sb: pinctrl@18800 {
@@ -337,6 +353,12 @@
 					<GIC_SPI 157 IRQ_TYPE_LEVEL_HIGH>,
 					<GIC_SPI 156 IRQ_TYPE_LEVEL_HIGH>;
 				};
+
+				rgmii_pins: mii-pins {
+					groups = "rgmii";
+					function = "mii";
+				};
+
 			};
 
 			gpio_nb: gpio@13800 {
-- 
2.7.4

